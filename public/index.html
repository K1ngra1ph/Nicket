<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NICKET Free VIP Tickets</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

  <meta name="description" content="Register for free to get VIP event tickets with Nicket and party across Nigeria. Play games to win backstage passes!">
  <meta name="theme-color" content="#c1272d">

  <style>
    :root{
      --bg-color: #fff9fc;
      --text-color: #1e293b;
      --card-bg: #fffdf8;
      --border-color: #cbd5e1;
      --modal-bg: #ffffff;
      --modal-text: #1e293b;
      --btn-bg: #c1272d;
      --btn-text: #ffffff;
      --footer-bg: #f1f5f9;
    }

    body.dark{
      --bg-color:#2c2c2c;
      --text-color:#e2e8f0;
      --card-bg:#1e293b;
      --border-color:#334155;
      --modal-bg:#1e293b;
      --modal-text:#cbd5e1;
      --btn-bg:#ffd700;
      --btn-text:#1c1c1c;
      --footer-bg:#1e293b;
    }

    /* Page basics */
    html,body { height:100%; }
    body{
      margin:0;
      font-family: 'Poppins', sans-serif;
      background:var(--bg-color);
      color:var(--text-color);
      padding:20px;
      transition: background 0.3s ease, color 0.3s ease;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Logo & theme */
    .logo{
      position:fixed;
      top:30px;
      left:30px;
      width:120px;
      height:auto;
      z-index:2000;
    }

    .theme-toggle{
      position:fixed;
      top:20px;
      right:20px;
      background:var(--btn-bg);
      color:var(--btn-text);
      border:none;
      border-radius:50px;
      padding:8px 14px;
      font-weight:600;
      cursor:pointer;
      box-shadow:0 2px 6px rgba(0,0,0,.18);
      z-index:2000;
      transition: transform .12s ease, background .3s ease;
    }
    .theme-toggle:active{ transform: translateY(1px) }

    /* Form card */
    .form-container{
      background:var(--card-bg);
      padding:25px;
      border-radius:12px;
      max-width:520px;
      margin:100px auto 0;
      box-shadow:0 6px 20px rgba(20,20,20,0.06);
      transition: background 0.3s ease, color 0.3s ease;
    }

    label{ display:block; font-weight:600; margin-top:10px; font-size:14px; }
    input, select{
      width:100%;
      padding:10px;
      margin:8px 0 12px;
      border:1px solid var(--border-color);
      border-radius:8px;
      font-size:15px;
      background:var(--card-bg);
      color:var(--text-color);
      transition: border-color .15s ease, box-shadow .15s ease;
      box-sizing:border-box;
    }
    input:focus, select:focus{ outline: none; border-color: rgba(193, 41, 45, .9); box-shadow: 0 3px 10px rgba(0,0,0,0.06); }

    .phone-group{ display:flex; gap:10px; align-items:center; }
    .phone-group select{ width:30%; }
    .phone-group input{ width:70%; }

    .submit-wrap{ text-align:center; margin-top:20px; }
    button.primary{
      background:var(--btn-bg);
      color:var(--btn-text);
      border:none;
      border-radius:8px;
      padding:10px 22px;
      font-size:16px;
      font-weight:600;
      cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    button.primary:active{ transform: translateY(1px) }
    button.primary:disabled{ opacity:.6; cursor:not-allowed; transform:none; }

    /* Modal overlay */
    #feedbackModal{
      display:none;
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.48);
      justify-content:center;
      align-items:center;
      z-index:10000;
      opacity:0;
      transition: opacity .28s ease;
    }
    #feedbackModal.show{ display:flex; opacity:1; }

    .modal-content{
      position:relative;
      background:var(--modal-bg);
      border-radius:12px;
      padding:22px;
      max-width:450px;
      width:92%;
      text-align:left;
      box-shadow:0 8px 28px rgba(0,0,0,0.25);
      animation: popIn 0.35s cubic-bezier(.2,.8,.2,1);
      color:var(--modal-text);
      transition: background .3s ease, color .3s ease;
    }

    .modal-inner{ text-align:left; }
    .modal-inner h3{ margin:0 0 8px; font-size:20px; }
    .modal-inner p{ margin:0; font-size:15px; line-height:1.5; color:var(--modal-text); }

    .modal-close-row{ display:flex; justify-content:flex-end; }
    .modal-btn{
      display:inline-block;
      background:var(--btn-bg);
      color:var(--btn-text);
      border:none;
      border-radius:8px;
      padding:8px 16px;
      font-weight:600;
      cursor:pointer;
      margin-top:16px;
    }

    .close-btn{
      position:absolute;
      top:10px;
      right:14px;
      background:transparent;
      border:none;
      font-size:20px;
      color:var(--modal-text);
      cursor:pointer;
      transition: transform .18s ease;
    }
    .close-btn:hover{ transform: scale(1.2) }

    /* Game rules box inside modal */
    .rules-box{
      background:#f1f5f9;
      padding:12px 15px;
      border-radius:8px;
      margin-top:15px;
      text-align:left;
    }
    .rules-box h4{ margin:0 0 8px; font-size:15px; }
    .rules-box ul{ margin:0; padding-left:20px; line-height:1.6; color:#0f172a; }

    footer{
      margin-top:40px;
      background:var(--footer-bg);
      text-align:center;
      padding:15px;
      border-radius:10px;
      transition: background .3s ease;
    }
    footer a{ color:var(--text-color); text-decoration:none; font-weight:500; margin:0 10px; }
    footer a:hover{ color:var(--btn-bg); text-decoration:underline; }

    .contact-btn{
      position:fixed;
      bottom:20px;
      right:20px;
      background:var(--btn-bg);
      color:var(--btn-text);
      border:none;
      border-radius:50px;
      padding:12px 20px;
      font-weight:600;
      box-shadow:0 6px 18px rgba(0,0,0,.12);
      cursor:pointer;
      z-index:1000;
      transition: transform .12s ease;
    }
    .contact-btn:hover{ transform: scale(1.04) }

    /* small screens */
    @media (max-width:520px){
      .form-container{ margin:80px 18px 0; padding:18px; }
      .logo{ width:100px; left:18px; top:22px; }
    }

    /* animations */
    @keyframes popIn{ from{ transform: scale(.92); opacity:0 } to{ transform: scale(1); opacity:1 } }
    @keyframes fadeInUp{ from{ opacity:0; transform: translateY(10px) } to{ opacity:1; transform: translateY(0) } }
  </style>
</head>

<body>
  <img src="assets/images/nicket-logo.png" alt="Nicket Logo" class="logo">

  <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">‚òÄÔ∏è</button>

  <div class="form-container" role="region" aria-labelledby="registrationTitle">
    <h2 id="registrationTitle" style="margin:0 0 12px;">Register for VIP Tickets</h2>

    <label for="name">Name</label>
    <input id="name" type="text" placeholder="Enter your full name" required autocomplete="name">

    <label for="email">Email</label>
    <input id="email" type="email" placeholder="Enter your email" required autocomplete="email">

    <label for="phone">Phone Number</label>
    <div class="phone-group">
      <select id="countryCode" aria-label="Country code" required>
        <option value="+234">+234</option>
        <option value="+1">+1</option>
        <option value="+44">+44</option>
        <option value="+233">+233</option>
      </select>
      <input id="phone" type="tel" placeholder="Enter your phone number" required autocomplete="tel-national">
    </div>

    <label for="event">Select Event</label>
    <select id="event" required>
      <option value="">-- Choose Event --</option>
      <option value="Soakers" data-location="Tafawa Balewa Square, Lagos" data-date="Dec 15, 2025">Soakers</option>
      <option value="Monochrome" data-location="The Palms, Victoria Island" data-date="Dec 8, 2025">Monochrome</option>
      <option value="Vibe The Fest" data-location="Port Harcourt Stadium" data-date="Dec 20, 2025">Vibe The Fest</option>
    </select>

    <div id="eventDetails" style="margin-top:10px; font-size:15px; line-height:1.5;"></div>

    <div class="submit-wrap">
      <button id="submitBtn" class="primary" type="button">I Don Ready</button>
    </div>
  </div>

  <!-- Modal -->
  <div id="feedbackModal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-content" role="document" aria-describedby="modalMessage">
      <button class="close-btn" id="closeModalBtn" aria-label="Close modal">‚úñ</button>

      <div class="modal-inner">
        <h3 id="modalTitle">Notice</h3>
        <div id="modalMessage">
          <p>Please fill all fields before proceeding.</p>
        </div>

        <!-- action button -->
        <div style="text-align:right;">
          <button class="modal-btn" id="modalCloseBtn">OK</button>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <a href="about.html">About Us</a> |
    <a href="privacy.html">Privacy Policy</a> |
    <a href="terms.html">Terms & Conditions</a>
  </footer>

  <button class="contact-btn" onclick="location.href='contact.html'">Contact Us</button>

  <script>
    /* --------------------------
       Element references
       -------------------------- */
    const themeToggle = document.getElementById('themeToggle');
    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const phoneInput = document.getElementById('phone');
    const countryCodeSelect = document.getElementById('countryCode');
    const eventSelect = document.getElementById('event');
    const eventDetails = document.getElementById('eventDetails');
    const submitBtn = document.getElementById('submitBtn');

    const feedbackModal = document.getElementById('feedbackModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalMessage = document.getElementById('modalMessage');
    const modalCloseBtn = document.getElementById('modalCloseBtn');
    const closeModalBtn = document.getElementById('closeModalBtn');

    /* --------------------------
       Theme toggle (persist)
       -------------------------- */
    (function initTheme(){
      const currentTheme = localStorage.getItem('theme');
      if (currentTheme === 'dark') {
        document.body.classList.add('dark');
        themeToggle.textContent = 'üåô';
      }
      themeToggle.addEventListener('click', () => {
        document.body.classList.toggle('dark');
        const isDark = document.body.classList.contains('dark');
        themeToggle.textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
        try { localStorage.setItem('theme', isDark ? 'dark' : 'light'); } catch (e) {}
      });
    })();

    /* --------------------------
       Event details display
       -------------------------- */
    eventSelect.addEventListener('change', () => {
      const opt = eventSelect.selectedOptions[0];
      const loc = opt?.getAttribute('data-location');
      const date = opt?.getAttribute('data-date');

      if (eventSelect.value && loc && date) {
        eventDetails.innerHTML = `<strong>üìç Location:</strong> ${loc}<br><strong>üìÖ Date:</strong> ${date}`;
      } else {
        eventDetails.innerHTML = '';
      }
    });

    /* --------------------------
       Modal helper
       - showModal(title, contentHTML, color, redirectUrl)
       -------------------------- */
    function showModal(title, contentHTML, color = '#1e293b', redirect = null) {
      modalTitle.textContent = title;
      modalTitle.style.color = color;
      modalMessage.innerHTML = contentHTML;
      feedbackModal.classList.add('show');
      feedbackModal.setAttribute('aria-hidden','false');

      // Close behavior
      function cleanupAndMaybeRedirect() {
        feedbackModal.classList.remove('show');
        feedbackModal.setAttribute('aria-hidden','true');
        feedbackModal.removeEventListener('click', overlayHandler);
        closeModalBtn.removeEventListener('click', closeHandler);
        modalCloseBtn.removeEventListener('click', closeHandler);
        if (redirect) {
          setTimeout(() => { location.href = redirect; }, 260);
        }
      }
      // handlers
      function closeHandler(e){ e && e.preventDefault(); cleanupAndMaybeRedirect(); }
      function overlayHandler(e){
        // click outside modal content closes modal
        if (e.target === feedbackModal) cleanupAndMaybeRedirect();
      }

      // attach handlers
      closeModalBtn.addEventListener('click', closeHandler);
      modalCloseBtn.addEventListener('click', closeHandler);
      feedbackModal.addEventListener('click', overlayHandler);
    }

    /* --------------------------
       Keep old showModal(name, eventValue, email, phone, countryCode) behavior too
       (for registration success flow)
       -------------------------- */
    function showRegistrationModal(name, eventValue, email, phone, countryCode) {
      const content = `
        <div style="animation:fadeInUp .45s ease;">
          <p style="font-size:16px; line-height:1.6;">
            Thank you, <strong>${escapeHtml(name)}</strong>! You‚Äôve successfully registered for
            <strong>${escapeHtml(eventValue)}</strong>.
          </p>

          <div class="rules-box">
            <h4>üéÆ Game Rules:</h4>
            <ul>
              <li>Pick your numbers carefully ‚Äî once submitted, you can‚Äôt change them.</li>
              <li>Winners will be announced before the event day.</li>
              <li>Ensure your contact details are correct to receive your VIP/Backstage ticket.</li>
              <li>Incomplete or invalid registrations may be disqualified.</li>
            </ul>
          </div>

          <p style="margin-top:18px;">Click <strong>OK</strong> to continue to the game page.</p>
        </div>
      `;
      // Save user data to localStorage (safe)
      const userData = {
        name: name.trim(),
        email: email.trim(),
        phone: `${countryCode}${phone.trim()}`,
        eventValue: eventValue.trim()
      };
      try { localStorage.setItem('userData', JSON.stringify(userData)); } catch (e) { /* ignore storage errors */ }

      showModal('Registration Successful üéâ', content, '#16a34a', 'game.html');
    }

    /* --------------------------
       Simple HTML escape for insertion into modal content
       -------------------------- */
    function escapeHtml(str = '') {
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    /* --------------------------
       Form submit
       - preserves old validation & modal error behavior
       -------------------------- */
    submitBtn.addEventListener('click', (e) => {
      e.preventDefault();

      const name = nameInput.value.trim();
      const email = emailInput.value.trim();
      const phone = phoneInput.value.trim();
      const countryCode = countryCodeSelect.value.trim();
      const eventValue = eventSelect.value.trim();

      if (!name || !email || !phone || !eventValue) {
        // show error modal (red)
        showModal('Error', `<p>Please fill in all required fields.</p>`, '#dc2626', null);
        return;
      }

      // call the same registration modal as before
      showRegistrationModal(name, eventValue, email, phone, countryCode);
    });

    /* --------------------------
       Modal behavior for payment result from payment-status.html
       - index.html?payment=success  => auto shows success modal
       -------------------------- */
    (function checkPaymentQuery() {
      const params = new URLSearchParams(window.location.search);
      const paymentFlag = params.get('payment'); // e.g., "success" or "failed"
      if (paymentFlag === 'success') {
        // Show a compact success confirmation (but keep rules available via a "View details" link)
        const content = `
          <div style="animation:fadeInUp .35s ease;">
            <p style="font-size:16px; line-height:1.6;">
              Your payment was successful. Thank you! Your registration has been confirmed.
            </p>
            <div style="margin-top:12px;">
              <button id="viewRulesBtn" style="background:transparent;border:1px solid var(--border-color);padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600;">View Game Rules</button>
            </div>
          </div>
        `;
        showModal('Payment Successful üéâ', content, '#16a34a', null);

        // attach handler for view rules (delegated because button is created dynamically)
        setTimeout(() => {
          const vr = document.getElementById('viewRulesBtn');
          if (vr) {
            vr.addEventListener('click', (ev) => {
              ev.preventDefault();
              // replace modal content with the detailed registration content (no redirect)
              const stored = (() => {
                try { return JSON.parse(localStorage.getItem('userData') || '{}'); } catch(e){ return {}; }
              })();
              const displayName = stored.name || nameInput.value || 'Player';
              const displayEvent = stored.eventValue || eventSelect.value || 'Selected event';

              const detailsHtml = `
                <div style="animation:fadeInUp .45s ease;">
                  <p style="font-size:16px; line-height:1.6;">
                    Thank you, <strong>${escapeHtml(displayName)}</strong> ‚Äî your payment is confirmed for
                    <strong>${escapeHtml(displayEvent)}</strong>.
                  </p>
                  <div class="rules-box">
                    <h4>üéÆ Game Rules:</h4>
                    <ul>
                      <li>Pick your numbers carefully ‚Äî once submitted, you can‚Äôt change them.</li>
                      <li>Winners will be announced before the event day.</li>
                      <li>Ensure your contact details are correct to receive your VIP/Backstage ticket.</li>
                      <li>Incomplete or invalid registrations may be disqualified.</li>
                    </ul>
                  </div>
                </div>
              `;
              // reuse showModal but without redirect
              showModal('Payment Details', detailsHtml, '#16a34a', null);
            });
          }
        }, 120);
      }
    })();

    /* --------------------------
       Utility: close modal with ESC
       -------------------------- */
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && feedbackModal.classList.contains('show')) {
        feedbackModal.classList.remove('show');
        feedbackModal.setAttribute('aria-hidden','true');
      }
    });

    /* --------------------------
       Accessibility: trap focus inside modal while open (basic)
       -------------------------- */
    (function modalFocusTrap(){
      let lastFocused = null;
      const focusableSelectors = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';

      document.addEventListener('focusin', (e) => {
        if (feedbackModal.classList.contains('show')) {
          // if focus moves outside the modal, move it back to modal
          if (!feedbackModal.contains(e.target)) {
            e.stopPropagation();
            const first = feedbackModal.querySelector(focusableSelectors);
            if (first) first.focus();
          }
        }
      });

      // record last focused before opening modal
      const origShowModal = showModal;
      window.showModal = function(...args){ lastFocused = document.activeElement; origShowModal(...args); };
    })();

    /* --------------------------
       Prevent accidental form submit on Enter inside inputs (optional)
       -------------------------- */
    [nameInput, emailInput, phoneInput].forEach(inp => {
      inp && inp.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') e.preventDefault();
      });
    });
  </script>
</body>
</html>
